{% extends "blog/base2.html" %}

{% load blog_tags %}

{% block title %}
{{ post.title }}
{% endblock %}

{% block content %}
<div class="post hentry category-news tag-tag tag-yes" id="post-{{ post.pk }}">
   <div class="post_header_single">
    <h1 align="center">{{ post.title }}</h1>
    <br>
    <span class="tags">
  	 标签:
  	 {% for tag in post.tags.all %}
  		  <a href={% url "blog:post_list_by_tag" tag.slug %}>{{ tag.name }}</a>
  	 {% empty %}
  	 {% endfor %}
    </span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <span class="date" style="margin-right: 10px">
      发布于{{ post.publish }}  &nbsp;&nbsp;&nbsp;&nbsp;作者: {{ post.author }}
    </span>
  </div>

  <div class = "post_body_single">
  {{ post.body|markdown|safe }}
  </div>
  <div class="post_footer_single">
  <strong>
  	<a href="{% url "blog:post_share" post.id %}">
  		Share this Post...
  	</a>
  </strong>
  </div>


 <div id="comments">

  {% if new_comment %}
    <h2>评论成功.</h2>
  {% else %}
      <h2>添加评论</h2>
      <form action="{% url 'comments:post_comment' post.publish.year post.publish.month post.publish.day post.slug %}" method="post">
        {{ comment_form.as_p }}
        {% csrf_token %}
        <p align=center><input type="submit" value="点击提交评论"></p>
      </form>
  {% endif %}


  {% with post.comments.count as total_comments %}
    <h2 align="center">
      共{{ total_comments }} 条评论.
    </h2>
  {% endwith %}



  {% for comment in post.comments.all %}
      <div class="comment">
        <p class="info">
          {{ comment.name }}&nbsp; &nbsp; {{ comment.created }} &nbsp;&nbsp;#{{ forloop.revcounter }} 
        </p>
        {{ comment.body|linebreaks }}
      </div>
  {% empty %}
      <p>还没有评论.</p>
  {% endfor %}


  </div>
</div>


{% endblock %}

{% block related %}
<li class="sidebar_nav">
          
<h3>Related Posts</h3>
            
<ul>
{% for post in similar_posts %}
      <li>
        <a href="{{ post.get_absolute_url }}">{{ post.title }}</a>
      </li>
{% empty %}
{% endfor %}
</ul>

</li>
{% endblock %}